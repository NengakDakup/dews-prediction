{{> header }}

<!-- ================================
    START HERO-WRAPPER AREA
================================= -->
<section class="hero-wrapper overflow-hidden">
    <div class="overlay"></div><!-- end overlay -->
    <div id="fullscreen-slide-container">
        <ul class="slides-container">
            <li><img class="lazy" src="images/img-loading.html" data-src="images/banner1.jpg" alt=""></li>
            <li><img class="lazy" src="images/img-loading.html" data-src="images/banner1.jpg" alt=""></li>
            <li><img class="lazy" src="images/img-loading.html" data-src="images/banner1.jpg" alt=""></li>
        </ul>
    </div><!-- End fullscreen-slide-container -->
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="hero-heading text-center">
                    <div class="section-heading">
                        <h2 class="sec__title cd-headline slide">
                           Prediction For {{state}}
                        </h2>
                        
                    </div>
                    <div class="section-body text-center">
                        <form action="#" class="form-box ">
                            <div class="form-group mb-0">
                                
                                <input type="number" min="1999" max="2030" class="form-control mt-3 year" placeholder="Input The Year You want to predict for">
                            </div>
                            <div class="form-group mb-0 mt-3">
                                <a href="#" class="theme-btn gradient-btn shadow-none add-listing-btn-hide predict-btn">
                                <i class="la la-plus mr-2"></i>Run Prediction
                            </a>
                            </div>
                        </form> 
                    </div>
                </div><!-- end hero-heading -->
            </div><!-- end col-lg-12 -->
        </div><!-- end row -->
    </div><!-- end container -->
    <div class="svg-bg">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" preserveAspectRatio="none">
            <path fill="#F5F7FC" class="elementor-shape-fill" d="M500,97C126.7,96.3,0.8,19.8,0,0v100l1000,0V1C1000,19.4,873.3,97.8,500,97z"></path>
        </svg>
    </div>
</section><!-- end hero-wrapper -->
<!-- ================================
    END HERO-WRAPPER AREA
================================= -->

<script>
    let btn = document.querySelector('.predict-btn');
    btn.addEventListener('click', () => {
        btn.innerText = 'Loading...';
        let year = document.querySelector('.year').value;
        let state = "{{state}}";


        if(!year){
            return alert("Please Enter a Valid Year");
        } else if(year > 2030){
            return alert("Please Enter a Year Not Greater Than 2030");
        } else {
            let data = {
                year: year * 1,
                state: state.toUpperCase()
            };

            fetch("https://dewsapp.herokuapp.com/dews/pred/", {
                method: "POST", 
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).then(res => {
                return res.json()
            }).then(data => {
                document.querySelector('.state_res').innerText = state;
                document.querySelector('.year_res').innerText = data.year;
                document.querySelector('.drought_index').innerText = data.drought_index;
                document.querySelector('.ocean_temp').innerText = data.ocean_temperature;
                document.querySelector('.climate_dir').innerText = data.climate_direction;
                
                $('#resultModal').modal('show')
                btn.innerHTML = '<i class="la la-plus mr-2"></i>Run Prediction';
            }).catch(err => {
                alert('An Error Occured Please Try Again')
                btn.innerHTML = '<i class="la la-plus mr-2"></i>Run Prediction'
            })
        }
    })
</script>

{{> footer }}